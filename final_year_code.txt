#include <SoftwareSerial.h>
int sensor = 8;
int buzzer = A1;
int motor = 6;
int buzzer2=A2;
SoftwareSerial gsmSerial(2,3); // RX, TX. 
void setup()
{ 
     gsmSerial.begin(9600);
  delay(1000);
 Serial.begin(9600);
  pinMode(buzzer, OUTPUT);
  pinMode(sensor,INPUT);
  pinMode(motor,OUTPUT);
  pinMode(10, INPUT); // Setup for leads off detection LO +
pinMode(11, INPUT); // Setup for leads off detection LO -

  digitalWrite(motor,HIGH);
}
void sendSMS() {


  Serial.println("Initializing...");

  gsmSerial.println("AT"); // Check if the module is responding
  delay(1000);

  gsmSerial.println("AT+CMGF=1"); // Set SMS mode to text
  delay(1000);

  gsmSerial.print("AT+CMGS=\"+919989281832\"\r"); // Replace with the recipient's phone number
  delay(1000);

  gsmSerial.print("Alert driver is in problem driver phone: +919032791832"); // Your SMS message
  delay(100);

  gsmSerial.write(26); // Send Ctrl+Z to end the message
  delay(1000);

  Serial.println("Message sent.");
}

// the loop function runs over and over again forever
void loop() {
  if(digitalRead(sensor)==1)
  {
    analogWrite(buzzer,100);
    digitalWrite(motor,LOW);
analogWrite(buzzer2,100);
  }
  else
  {
    analogWrite(buzzer,1000);
    digitalWrite(motor,HIGH);
    
          delay(5000);
    while(digitalRead(sensor)==0){
      analogWrite(buzzer2,1000); 
      delay(5000);
      }
      
      delay(1000);
    
  }
while((digitalRead(10) == 1)||(digitalRead(11) == 1)){
  Serial.println('!');
 
 analogWrite(buzzer,1000);

 
      analogWrite(buzzer2,1000);
       digitalWrite(motor,HIGH);


      sendSMS();
       delay(5000);
}

// send the value of analog input 0:
Serial.println(analogRead(A0));
analogWrite(buzzer2,100);
analogWrite(buzzer,100);

//Wait for a bit to keep serial data from saturating
delay(1);
}